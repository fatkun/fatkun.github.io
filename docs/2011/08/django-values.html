<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Django values(*fields) 如何使用 - Fatkun&#39;s Blog</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="fatkun" /><meta name="description" content="官方文档:https://docs.djangoproject.com/en/1.3/ref/models/querysets/#value" /><meta name="keywords" content="Hugo, fatkun" />






<meta name="generator" content="Hugo 0.70.0 with theme even" />


<link rel="canonical" href="https://fatkun.github.io/2011/08/django-values.html" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f8d981be68d2538153a6e4ce23201045e9549712aa5905499cc22691b43378b0.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Django values(*fields) 如何使用" />
<meta property="og:description" content="官方文档:https://docs.djangoproject.com/en/1.3/ref/models/querysets/#value" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://fatkun.github.io/2011/08/django-values.html" />
<meta property="article:published_time" content="2011-08-14T09:08:12+00:00" />
<meta property="article:modified_time" content="2011-08-14T09:08:12+00:00" />
<meta itemprop="name" content="Django values(*fields) 如何使用">
<meta itemprop="description" content="官方文档:https://docs.djangoproject.com/en/1.3/ref/models/querysets/#value">
<meta itemprop="datePublished" content="2011-08-14T09:08:12&#43;00:00" />
<meta itemprop="dateModified" content="2011-08-14T09:08:12&#43;00:00" />
<meta itemprop="wordCount" content="872">



<meta itemprop="keywords" content="django,python,values," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Django values(*fields) 如何使用"/>
<meta name="twitter:description" content="官方文档:https://docs.djangoproject.com/en/1.3/ref/models/querysets/#value"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Fatkun&#39;s Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">首页</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">存档</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">标签</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">分类</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">关于</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Fatkun&#39;s Blog</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">首页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">存档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">标签</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">分类</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">关于</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Django values(*fields) 如何使用</h1>

      <div class="post-meta">
        <span class="post-time"> 2011-08-14 </span>
        <div class="post-category">
            <a href="/categories/python/"> python </a>
            </div>
          <span class="more-meta"> 约 872 字 </span>
          <span class="more-meta"> 预计阅读 2 分钟 </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents"></nav>
  </div>
</div>
    <div class="post-content">
      <div>  <p>    官方文档:<a href="https://docs.djangoproject.com/en/1.3/ref/models/querysets/#values">https://docs.djangoproject.com/en/1.3/ref/models/querysets/#values</a>  </p>
  <h1>    1. values(*fields)  </h1>
  <p>    这个方法返回的是ValuesQuerySet,是QuerySet 的子类，也就是说，你可以用QuerySet里的方法。 需要注意的是，返回的不是list，不要直接当list来用了。对ValuesQuerySet遍历，每一个元素是“字典”dict。  </p>
  <p>    当不传入参数时，返回这个model的所有字段  </p>
  <pre escaped="true" lang="python">AppDef.objects.values()
[{'creator': u'admin', 'apptype_name': u'uc3g', 'apptype_chn_name': u'3G\u95e8\u6237', 'note': u'', ...},...]</pre>
  <p>    当传入参数时，只会列出你指定的参数  </p>
  <pre escaped="true" lang="python">AppDef.objects.values('apptype_name')
[{'apptype_name': u'uc3g'},...]</pre>
  <p>    也可以加上<span style="font-family: 'Courier New';">filter</span><span style="font-family: 宋体;">，</span><span style="font-family: 'Courier New';">filter</span><span style="font-family: 宋体;">在前或者后面都是一样的</span>  </p>
  <pre escaped="true" lang="python">AppDef.objects.filter(pk=1).values('apptype_name')
AppDef.objects.values('apptype_name').filter(pk=1)</pre>
  <p>    如果想把关联的字段也一起查出来<br /> OneToOneField, ForeignKey 和ManyToManyField 关系的都可以。<br /> ManyToManyField 在Django1.3<span style="font-family: 微软雅黑;">版后才支持</span><br /> LogTypeDef定义了一个app<span style="font-family: 宋体;">的</span><span style="font-family: 'Courier New';">ForeignKey</span>  </p>
  <pre escaped="true" lang="python">LogTypeDef.objects.filter(pk=6).values('pk', 'app__apptype_name')
[{'pk': 6L, 'app__apptype_name': u'wapsearch'}]</pre>
  <p>    如果你只想拿到app_id<span style="font-family: 宋体;">，可以这样</span><br /> 下面三种方法都是一样的，只是返回的结果名字对应你的查询语句  </p>
  <pre escaped="true" lang="python">LogTypeDef.objects.filter(pk=6).values('pk', 'app_id')
LogTypeDef.objects.filter(pk=6).values('pk', 'app')
LogTypeDef.objects.filter(pk=6).values('pk', 'app__id')</pre>
  <p>    注意在关联关系为多对多的时候，它只会帮你一条一条的列出来，而不会帮你合并为一个<span style="font-family: 'Courier New';">list</span><span style="font-family: 宋体;">。</span><br /> 例如会返回类型的结果：同一个<span style="font-family: 'Courier New';">pk</span><span style="font-family: 宋体;">并不会帮你合并</span><span style="font-family: 'Courier New';">app_id</span>  </p>
  <pre escaped="true" lang="python">[{pk: 6, app_id: 2}, {pk: 6, app_id: 3}]</pre>
  <h1>    2. 注意事项  </h1>
  <p>    当同时使用distinct()和values()，需要注意order_by() (或者默认 model ordering) ，会自动加入select 中作为distinct项，所以返回的结果你以为是重复的，其实是order by的字段没列出来。<br /> 如果在extra() 之后用values()，一定要把extra用到的字段也加进来；如果extra()在values()之后，extra的字段会自动加进select。<br /> Because <a href="https://docs.djangoproject.com/en/1.3/ref/models/fields/#django.db.models.ManyToManyField">ManyToManyField</a> attributes and reverse relations can have multiple related rows, including these can have a multiplier effect on the size of your result set. This will be especially pronounced if you include multiple such fields in your values() query, in which case all possible combinations will be returned. (<span style="font-family: 微软雅黑;">这个不太懂什么意思，应该是当</span><span style="font-family: Arial;">values</span><span style="font-family: 微软雅黑;">有多个</span><span style="font-family: Arial;">manytomanyfield</span><span style="font-family: 微软雅黑;">的时候，会尽量合并一些</span><span style="font-family: Arial;">)</span>  </p>
  <h1>    3. 适用范围  </h1>
  <p>    l 只需要返回<span style="font-family: Arial;">dict</span><span style="font-family: 微软雅黑;">，而不需要返回</span><span style="font-family: Arial;">model object</span><span style="font-family: 微软雅黑;">。</span><br /> l 只需要返回简单的数据（包括层次简单）  </p>
  <h1>    4. Values_list  </h1>
  <p>    和<span style="font-family: Arial;">values</span><span style="font-family: 微软雅黑;">一样，只是返回的不是字典而是元组。</span> </div>
    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">fatkun</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2011-08-14
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/django/">django</a>
          <a href="/tags/python/">python</a>
          <a href="/tags/values/">values</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/2011/08/change-theme.html">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">更换新主题</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/2011/06/formpanel-get-combobox-value.html">
            <span class="next-text nav-default">Extjs FormPanel.getForm().getValues()对下拉框(Combobox)取值的问题</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="https://github.com/fatkun" class="iconfont icon-github" title="github"></a>
  <a href="https://fatkun.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2009 - 
    2021<span class="heart"><i class="iconfont icon-heart"></i></span><span>fatkun</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c12618f9a600c40bd024996677e951e64d3487006775aeb22e200c990006c5c7.js"></script>








</body>
</html>
